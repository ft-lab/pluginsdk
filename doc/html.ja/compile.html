<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>コンパイル</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- 作成： Doxygen 1.7.4 -->
<div id="top">
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>メインページ</span></a></li>
      <li class="current"><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('compile.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">コンパイル </div>  </div>
</div>
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="windows"></a>
■Windows</h2>
<h2><a class="anchor" id="compile_new_project_windows"></a>
■Visual C++ 2008/2010でのShadeプラグイン用の新規プロジェクト作成方法</h2>
<h3><a class="anchor" id="compile_new_project_windows_step1"></a>
1.新規プロジェクトの作成</h3>
<ul>
<li>「ファイル(F)」メニューから「新規作成(N)」 &gt; 「プロジェクト(P)」を選択し、「新しいプロジェクト」ダイアログを出します。<br/>
 </li>
<li>「新しいプロジェクト」ダイアログのプロジェクトの種類から「Visual C++ プロジェクト」の「Win32」を選択します。<br/>
 </li>
<li>右側のテンプレートの項目の「Win32 プロジェクト」のテンプレートを選択します。<br/>
 </li>
<li>プロジェクトの名を入力して「OK」で次に進みます。<br/>
 </li>
<li>次に、Win32 アプリケーション ウィザードダイアログが表示されます。<br/>
 </li>
<li>Win32 アプリケーションウィザードの「アプリケーションの設定」のタブを選択します。<br/>
 </li>
<li>アプリケーションの種類を「DLL」に変更し、空のプロジェクトにチェックを入れて「完了」してプロジェクトを作成します。</li>
</ul>
<h3><a class="anchor" id="compile_new_project_windows_step2"></a>
2.プラグインプロジェクトの設定</h3>
<ul>
<li>ソリューションエクスプローラからプロジェクトを選択し、メニューのプロパティからプロジェクトページダイアログを表示します。<br/>
 </li>
<li>構成プロパティ &gt; C/C++ &gt; 全般の「追加のインクルード ディレクトリ」にヘッダーファイルのパスを追加 サンプルでは以下のようになっています。作成したプロジェクトとPluinSDKの位置に応じて変更して下さい。</li>
</ul>
<div class="fragment"><pre class="fragment"> ../../include;../../boost_1_43_0;../../include/openexr-1.6.1;../../include/opengl
</pre></div><ul>
<li>構成プロパティ &gt; C/C++ &gt; プリプロセッサの「プリプロセッサの定義」に以下の項目を追加してください。</li>
</ul>
<div class="fragment"><pre class="fragment"> PLUGIN=1;STDCALL=__stdcall;DLLEXPORT=__declspec(dllexport);<span class="keywordflow">for</span>=<span class="keywordflow">if</span>(<span class="keyword">true</span>)<span class="keywordflow">for</span>;SXWINDOWS;SXWIN32;_CRT_SECURE_NO_DEPRECATE;SXPLUGIN=1;_SECURE_SCL=0;PLUGIN_EXPORTS;SXCORE=;SXMODEL=
</pre></div><ul>
<li>サンプルでは以下のようになっています。</li>
</ul>
<div class="fragment"><pre class="fragment"> WIN32;NDEBUG;_WINDOWS;PLUGIN=1;STDCALL=__stdcall;DLLEXPORT=__declspec(dllexport);<span class="keywordflow">for</span>=<span class="keywordflow">if</span>(<span class="keyword">true</span>)<span class="keywordflow">for</span>;SXWINDOWS;SXWIN32;_CRT_SECURE_NO_DEPRECATE;SXPLUGIN=1;_SECURE_SCL=0;PLUGIN_EXPORTS;SXCORE=;SXMODEL=
</pre></div><ul>
<li>構成プロパティ &gt; C/C++ &gt; 詳細設定の「指定の警告を無効にする」に「4819」を追加してください。</li>
</ul>
<ul>
<li>プロジェクトにSDK付属のソースコードを追加 PluginSDKのinclude/sx/coreフォルダの「vectors.cpp」、「com.cpp」、「debug.cpp」をプロジェクトに追加します。</li>
</ul>
<h2><a class="anchor" id="MacOSX"></a>
■MacOSX</h2>
<h2><a class="anchor" id="compile_new_project_mac"></a>
■Xcode 3.2以降でのShadeプラグイン用の新規プロジェクト作成方法</h2>
<h3><a class="anchor" id="compile_new_project_mac_step1"></a>
1.新規プロジェクトの作成</h3>
<ul>
<li>ファイルメニューの新規プロジェクトからCocoa Bundleを選択し、「次へ」ボタンを押します。<br/>
 </li>
<li>プロジェクト名にプロジェクトの名称を、ディレクトリは横の「選択...」ボタンを選択してプロジェクトが作成されるフォルダを選択し「完了」ボタンを押します。<br/>
 </li>
<li>開かれたXcodeのWindowの左側にある「グループとファイル」ツリー内のFrameworks and Librariesの中を選択して、マウスを右クリック若しくはctrl+クリックで表示されるコンテクストメニューの「追加 &gt; 既存のフレームワーク...」を選択して、Carbonフレームワークを追加してください。<br/>
 </li>
<li>追加するCarbonフレームワークは/System/Library/Frameworksの中のCarbon.frameworkです。</li>
</ul>
<h3><a class="anchor" id="compile_new_project_mac_step2"></a>
2.プラグインプロジェクトの設定</h3>
<ul>
<li>「グループとファイル」ツリーの「ターゲット」項目の中のプロジェクト名の項目を選択して、「情報を見る」(command+i)で「ターゲット"プロジェクト名"の情報」を表示させます。<br/>
 </li>
<li>"ラッパーの拡張子"の"bundle"を"shdplugin"に変更します。<br/>
 </li>
<li>"ヘッダ検索パス"にShade 13 Plugin SDKのincludeとboost_1_43_0、include/openexr-1.6.1、include/opengl、のパスを記述します。<br/>
 </li>
<li>Shade 13 Plugin SDKのinclude/sx/coreの中にある vectors.cpp、 com.cpp、 debug.cpp を「グループとファイル」ツリーに追加します。<br/>
 </li>
<li>「グループとファイル」ツリーにあるプリコンパイルヘッダ(標準ではプロジェクト名.pch)に以下を追記してください。</li>
</ul>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #include &lt;Carbon/Carbon.h&gt;</span>
<span class="preprocessor"> #ifdef __OBJC__</span>
<span class="preprocessor"></span><span class="preprocessor"> #import &lt;Foundation/Foundation.h&gt;</span>
<span class="preprocessor"> #import &lt;AppKit/AppKit.h&gt;</span>
<span class="preprocessor"> #endif</span>
<span class="preprocessor"></span> 
<span class="preprocessor"> #define SXMACOSX 1</span>
<span class="preprocessor"></span><span class="preprocessor"> #define SXCARBON 1</span>
<span class="preprocessor"></span><span class="preprocessor"> #define PLUGIN 1</span>
<span class="preprocessor"></span><span class="preprocessor"> #define SXPLUGIN 1</span>
<span class="preprocessor"> #define __stdcall</span>
</pre></div><p>プロジェクトのオプション指定については、<a class="el" href="changes12_0_3.html">Shade 11 SDKからShade 12以降への変換</a> のページも参考にしてください。<br/>
設定が複雑ですので、サンプルプロジェクトより必要なものだけを取り出すのが手っ取り早いです。</p>
<h2><a class="anchor" id="sample_code"></a>
■プラグイン作成</h2>
<p>plugin_interfaceを使用した最小プラグインのサンプルソースを下に記します</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #include &quot;sxsdk.cxx&quot;</span>
 
 <span class="keyword">namespace </span>{
     <span class="keyword">const</span> sx::uuid_class SIMPLE_PLUGIN_ID(<span class="stringliteral">&quot;9255A624-549E-11D9-8D8E-000A95BACEB2&quot;</span>);
     <span class="keyword">class </span>simple_plugin_interface : <span class="keyword">public</span> sxsdk::plugin_interface {
     <span class="keyword">private</span>:
         <span class="keyword">virtual</span> <span class="keywordtype">int</span> get_shade_version ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> SHADE_BUILD_NUMBER; }
         <span class="keyword">virtual</span> sx::uuid_class <a class="code" href="dllentries_8h.html#aa885da437906315adb191d63e82f873d" title="プラグインIDを設定する。(プラグインID)">get_uuid</a> (<span class="keywordtype">void</span> *) { <span class="keywordflow">return</span> SIMPLE_PLUGIN_ID; }
         <span class="keyword">virtual</span> <span class="keywordtype">void</span> do_it (<a class="code" href="structsxsdk_1_1shade__interface.html" title="Shadeの情報へのアクセスの基本となるインターフェイス">sxsdk::shade_interface</a> *shade, <a class="code" href="structsxsdk_1_1scene__interface.html" title="シーンの情報の取得・設定に使用する。">sxsdk::scene_interface</a> *scene, <span class="keywordtype">void</span> *);
     };
 }
 <span class="keywordtype">void</span> simple_plugin_interface::do_it (<a class="code" href="structsxsdk_1_1shade__interface.html" title="Shadeの情報へのアクセスの基本となるインターフェイス">sxsdk::shade_interface</a> *shade, <a class="code" href="structsxsdk_1_1scene__interface.html" title="シーンの情報の取得・設定に使用する。">sxsdk::scene_interface</a> *scene, <span class="keywordtype">void</span> *) {
     shade-&gt;<a class="code" href="structsxsdk_1_1shade__interface.html#abde41aed9230aacfb7fdf8bd31baeace" title="メッセージウインドウに文字列を表示する。">message</a>(<span class="stringliteral">&quot;do_it : simple plugin&quot;</span>);
 }
 
 <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> __stdcall <a class="code" href="dllentries_8h.html#adc94c8f16008f9bf0fe6c86082bdb86f" title="インターフェイスの構築を行う。">create_interface</a> (<span class="keyword">const</span> IID &amp;iid, <span class="keywordtype">int</span> i, <span class="keywordtype">void</span> **p, <a class="code" href="structsxsdk_1_1shade__interface.html" title="Shadeの情報へのアクセスの基本となるインターフェイス">sxsdk::shade_interface</a> *shade, <span class="keywordtype">void</span> *) {
     <a class="code" href="classunknown__interface.html">unknown_interface</a> *u = <span class="keyword">new</span> simple_plugin_interface;
     u-&gt;AddRef();
     *p = (<span class="keywordtype">void</span> *)u;
 }
 <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">int</span> __stdcall <a class="code" href="dllentries_8h.html#a77be18c81060298895eacfbc0a58b81d" title="使用するインターフェイスの数を返す。">has_interface</a> (<span class="keyword">const</span> IID &amp;iid, <a class="code" href="structsxsdk_1_1shade__interface.html" title="Shadeの情報へのアクセスの基本となるインターフェイス">sxsdk::shade_interface</a> *shade) {
     <span class="keywordflow">if</span> (iid == plugin_iid) <span class="keywordflow">return</span> 1;
     <span class="keywordflow">return</span> 0;
 }
 <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * __stdcall <a class="code" href="dllentries_8h.html#a6f2ba000248080d52ec51c4260586bc0" title="プラグインの名前を返す。">get_name</a> (<span class="keyword">const</span> IID &amp;iid, <span class="keywordtype">int</span> i, <a class="code" href="structsxsdk_1_1shade__interface.html" title="Shadeの情報へのアクセスの基本となるインターフェイス">sxsdk::shade_interface</a> *shade, <span class="keywordtype">void</span> *) {
     <span class="keywordflow">if</span> (iid == plugin_iid) <span class="keywordflow">return</span> <span class="stringliteral">&quot;simple_plugin&quot;</span>;
     <span class="keywordflow">return</span> 0;
 }
 <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> sx::uuid_class __stdcall <a class="code" href="dllentries_8h.html#aa885da437906315adb191d63e82f873d" title="プラグインIDを設定する。(プラグインID)">get_uuid</a> (<span class="keyword">const</span> IID &amp;iid, <span class="keywordtype">int</span> i, <span class="keywordtype">void</span> *) {
     <span class="keywordflow">if</span> (iid == plugin_iid) <span class="keywordflow">return</span> SIMPLE_PLUGIN_ID;
     <span class="keywordflow">return</span> sx::uuid_class(0u);
 }
 <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * __stdcall <a class="code" href="dllentries_8h.html#a0f577a6d56ac9e2bd6c817102e6e8313" title="メニューのグループ名を定義する。">get_group_name</a> (<span class="keyword">const</span> IID &amp;iid, <a class="code" href="structsxsdk_1_1shade__interface.html" title="Shadeの情報へのアクセスの基本となるインターフェイス">sxsdk::shade_interface</a> *shade, <span class="keywordtype">void</span> *) {
     <span class="keywordflow">return</span> 0;
 }
 <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">bool</span> __stdcall <a class="code" href="dllentries_8h.html#a95c101e59aab6a25c48e46647f4e409e" title="常駐させるかどうかを設定する。">is_resident</a> (<span class="keyword">const</span> IID &amp;iid, <span class="keywordtype">int</span> i, <span class="keywordtype">void</span> *) {
     <span class="keywordflow">return</span> <span class="keyword">false</span>;
 }
</pre></div><p>・ サンプル補足</p>
<p>過去互換のプラグインIDはShade onlineのサポートページより申請をして取得する必要がありましたが、Shade 8よりget_uuid()から返すuuid_classをプラグイン毎に生成したUUIDを使用する事でプラグインIDとします。</p>
<p>UUID生成方法については<a class="el" href="pluginid.html">プラグインID</a> を参照してください。 </p>
</div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
<br><br>
<hr>
<div align="center">Copyright &copy; e frontier, Inc. All rights reserved.</div>
</body></html>
